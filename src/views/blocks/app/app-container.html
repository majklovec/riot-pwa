const riot = require('riot')
const StoreWatcher = require('../../../lib/utils/storex.js')
const RouterX = require('../../../lib/utils/routerx.js')

<app-container>

  <app-flash></app-flash>

  <script type="es6">
    let self = this
    // for validations
    //  - add a validationform
    //  - add a validate function in the handlers['<tag-name>'] section to set result
    //                into state.<store>.<validationform>.validated property
    self.stores = ['user'] // stores to watch
    self.validationform = [] // validation form . this will have validated field

    self.mixin(StoreWatcher)
    self.mixin(RouterX)

    self.on('mount', ()=>{
      let self = this
      if(!localStorage.getItem('user') && self._.global.authneeded == 'true'){
        self._.navTo(null, 'page=login&target=#app&fragment=start')
      }else{
        setTimeout(() => {
          // self._.navTo(null, 'page=feed&target=#app&fragment=feed')
        self._.navTo(null, 'page=login&target=#app&fragment=start')
          // self._.navTo(null, 'page=start&target=#app&fragment=message',{})
          riot.mount('*')

        }, 500)
      }
    })
  </script>
</app-container>
